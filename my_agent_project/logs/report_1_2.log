开始举报检测: token_id_a=1, token_id_b=2, user=0x9965507d1a55bcc2695c58ba16fb37d819b0a4dc
时间: 2025-05-26 23:40:36

开始从 IPFS 下载: cid=Qmdf1q4XorJmixhNAioH1EYVposcno5XbUH53aed6nDNu1
已成功下载到本地文件: ../my_agent_project/XRID/original_dataset.zip
开始从 IPFS 下载: cid=QmSPw6BTYXTmkNaputUSbTQyFFaCLZFCRQSzrmnpFErizq
已成功下载到本地文件: ../my_agent_project/XRID/suspicion_dataset.zip
2025-05-26 23:40:36,929 - INFO - 开始执行命令: python XRID.py --transform_dir ./original_dataset, cwd=XRID
[Step] 开始对 ./original_dataset 中的图像进行六种变换...
所有图片已移动至: ./original_dataset/original

正在应用变换: rotation (每次旋转10度，范围-90度到90度)
 Rotation rotation_-90:   0%|          | 0/100 [00:00<?, ?it/s] Rotation rotation_-90:  32%|███▏      | 32/100 [00:00<00:00, 315.07it/s] Rotation rotation_-90:  68%|██████▊   | 68/100 [00:00<00:00, 341.17it/s]                                                                          Rotation rotation_-80:   0%|          | 0/100 [00:00<?, ?it/s] Rotation rotation_-80:  37%|███▋      | 37/100 [00:00<00:00, 360.27it/s] Rotation rotation_-80:  77%|███████▋  | 77/100 [00:00<00:00, 379.34it/s]                                                                          Rotation rotation_-70:   0%|          | 0/100 [00:00<?, ?it/s] Rotation rotation_-70:  38%|███▊      | 38/100 [00:00<00:00, 372.46it/s] Rotation rotation_-70:  79%|███████▉  | 79/100 [00:00<00:00, 394.33it/s]                                                                          Rotation rotation_-60:   0%|          | 0/100 [00:00<?, ?it/s] Rotation rotation_-60:  40%|████      | 40/100 [00:00<00:00, 399.48it/s] Rotation rotation_-60:  84%|████████▍ | 84/100 [00:00<00:00, 419.21it/s]                                                                          Rotation rotation_-50:   0%|          | 0/100 [00:00<?, ?it/s] Rotation rotation_-50:  42%|████▏     | 42/100 [00:00<00:00, 414.88it/s] Rotation rotation_-50:  86%|████████▌ | 86/100 [00:00<00:00, 428.42it/s]                                                                          Rotation rotation_-40:   0%|          | 0/100 [00:00<?, ?it/s] Rotation rotation_-40:  42%|████▏     | 42/100 [00:00<00:00, 416.25it/s] Rotation rotation_-40:  84%|████████▍ | 84/100 [00:00<00:00, 415.94it/s]                                                                          Rotation rotation_-30:   0%|          | 0/100 [00:00<?, ?it/s] Rotation rotation_-30:  40%|████      | 40/100 [00:00<00:00, 389.91it/s] Rotation rotation_-30:  84%|████████▍ | 84/100 [00:00<00:00, 414.22it/s]                                                                          Rotation rotation_-20:   0%|          | 0/100 [00:00<?, ?it/s] Rotation rotation_-20:  39%|███▉      | 39/100 [00:00<00:00, 383.85it/s] Rotation rotation_-20:  81%|████████  | 81/100 [00:00<00:00, 401.83it/s]                                                                          Rotation rotation_-10:   0%|          | 0/100 [00:00<?, ?it/s] Rotation rotation_-10:  36%|███▌      | 36/100 [00:00<00:00, 355.90it/s] Rotation rotation_-10:  76%|███████▌  | 76/100 [00:00<00:00, 373.95it/s]                                                                          Rotation rotation_0:   0%|          | 0/100 [00:00<?, ?it/s] Rotation rotation_0:  37%|███▋      | 37/100 [00:00<00:00, 366.09it/s] Rotation rotation_0:  77%|███████▋  | 77/100 [00:00<00:00, 383.74it/s]                                                                        Rotation rotation_10:   0%|          | 0/100 [00:00<?, ?it/s] Rotation rotation_10:  32%|███▏      | 32/100 [00:00<00:00, 313.14it/s] Rotation rotation_10:  66%|██████▌   | 66/100 [00:00<00:00, 324.89it/s] Rotation rotation_10: 100%|██████████| 100/100 [00:00<00:00, 328.72it/s]                                                                          Rotation rotation_20:   0%|          | 0/100 [00:00<?, ?it/s] Rotation rotation_20:  37%|███▋      | 37/100 [00:00<00:00, 362.30it/s] Rotation rotation_20:  78%|███████▊  | 78/100 [00:00<00:00, 389.84it/s]                                                                         Rotation rotation_30:   0%|          | 0/100 [00:00<?, ?it/s] Rotation rotation_30:  40%|████      | 40/100 [00:00<00:00, 398.39it/s] Rotation rotation_30:  84%|████████▍ | 84/100 [00:00<00:00, 418.71it/s]                                                                         Rotation rotation_40:   0%|          | 0/100 [00:00<?, ?it/s] Rotation rotation_40:  36%|███▌      | 36/100 [00:00<00:00, 354.41it/s] Rotation rotation_40:  76%|███████▌  | 76/100 [00:00<00:00, 376.75it/s]                                                                         Rotation rotation_50:   0%|          | 0/100 [00:00<?, ?it/s] Rotation rotation_50:  25%|██▌       | 25/100 [00:00<00:00, 247.97it/s] Rotation rotation_50:  67%|██████▋   | 67/100 [00:00<00:00, 345.26it/s]                                                                         Rotation rotation_60:   0%|          | 0/100 [00:00<?, ?it/s] Rotation rotation_60:  38%|███▊      | 38/100 [00:00<00:00, 377.78it/s] Rotation rotation_60:  80%|████████  | 80/100 [00:00<00:00, 398.83it/s]                                                                         Rotation rotation_70:   0%|          | 0/100 [00:00<?, ?it/s] Rotation rotation_70:  35%|███▌      | 35/100 [00:00<00:00, 349.37it/s] Rotation rotation_70:  76%|███████▌  | 76/100 [00:00<00:00, 383.67it/s]                                                                         Rotation rotation_80:   0%|          | 0/100 [00:00<?, ?it/s] Rotation rotation_80:  36%|███▌      | 36/100 [00:00<00:00, 355.64it/s] Rotation rotation_80:  76%|███████▌  | 76/100 [00:00<00:00, 372.83it/s]                                                                         Rotation rotation_90:   0%|          | 0/100 [00:00<?, ?it/s] Rotation rotation_90:  37%|███▋      | 37/100 [00:00<00:00, 364.38it/s] Rotation rotation_90:  77%|███████▋  | 77/100 [00:00<00:00, 382.72it/s]                                                                        
正在应用变换: cropping (每次裁剪10%的边缘，范围10%到30%)
 Cropping cropping_10:   0%|          | 0/100 [00:00<?, ?it/s] Cropping cropping_10:  36%|███▌      | 36/100 [00:00<00:00, 357.24it/s] Cropping cropping_10:  75%|███████▌  | 75/100 [00:00<00:00, 373.63it/s]                                                                         Cropping cropping_20:   0%|          | 0/100 [00:00<?, ?it/s] Cropping cropping_20:  38%|███▊      | 38/100 [00:00<00:00, 374.37it/s] Cropping cropping_20:  78%|███████▊  | 78/100 [00:00<00:00, 384.19it/s]                                                                         Cropping cropping_30:   0%|          | 0/100 [00:00<?, ?it/s] Cropping cropping_30:  39%|███▉      | 39/100 [00:00<00:00, 382.96it/s] Cropping cropping_30:  78%|███████▊  | 78/100 [00:00<00:00, 382.17it/s]                                                                        
正在应用变换: scaling (每次缩放10%，范围80%到120%)
 Scaling scaling_80:   0%|          | 0/100 [00:00<?, ?it/s] Scaling scaling_80:  34%|███▍      | 34/100 [00:00<00:00, 339.06it/s] Scaling scaling_80:  71%|███████   | 71/100 [00:00<00:00, 355.82it/s]                                                                       Scaling scaling_90:   0%|          | 0/100 [00:00<?, ?it/s] Scaling scaling_90:  33%|███▎      | 33/100 [00:00<00:00, 329.82it/s] Scaling scaling_90:  69%|██████▉   | 69/100 [00:00<00:00, 343.41it/s]                                                                       Scaling scaling_100:   0%|          | 0/100 [00:00<?, ?it/s] Scaling scaling_100:  37%|███▋      | 37/100 [00:00<00:00, 361.49it/s] Scaling scaling_100:  77%|███████▋  | 77/100 [00:00<00:00, 379.03it/s]                                                                        Scaling scaling_110:   0%|          | 0/100 [00:00<?, ?it/s] Scaling scaling_110:  33%|███▎      | 33/100 [00:00<00:00, 329.45it/s] Scaling scaling_110:  68%|██████▊   | 68/100 [00:00<00:00, 341.20it/s]                                                                        Scaling scaling_120:   0%|          | 0/100 [00:00<?, ?it/s] Scaling scaling_120:  33%|███▎      | 33/100 [00:00<00:00, 323.48it/s] Scaling scaling_120:  69%|██████▉   | 69/100 [00:00<00:00, 341.84it/s]                                                                       
正在应用变换: color_adjustment (每次颜色调整0.5倍，范围0.5到2.0倍)
 Color_adjustment color_adjustment_0.5:   0%|          | 0/100 [00:00<?, ?it/s] Color_adjustment color_adjustment_0.5:  36%|███▌      | 36/100 [00:00<00:00, 356.59it/s] Color_adjustment color_adjustment_0.5:  76%|███████▌  | 76/100 [00:00<00:00, 375.04it/s]                                                                                          Color_adjustment color_adjustment_1.0:   0%|          | 0/100 [00:00<?, ?it/s] Color_adjustment color_adjustment_1.0:  36%|███▌      | 36/100 [00:00<00:00, 359.76it/s] Color_adjustment color_adjustment_1.0:  76%|███████▌  | 76/100 [00:00<00:00, 379.22it/s]                                                                                          Color_adjustment color_adjustment_1.5:   0%|          | 0/100 [00:00<?, ?it/s] Color_adjustment color_adjustment_1.5:  40%|████      | 40/100 [00:00<00:00, 391.44it/s] Color_adjustment color_adjustment_1.5:  82%|████████▏ | 82/100 [00:00<00:00, 404.12it/s]                                                                                          Color_adjustment color_adjustment_2.0:   0%|          | 0/100 [00:00<?, ?it/s] Color_adjustment color_adjustment_2.0:  41%|████      | 41/100 [00:00<00:00, 407.98it/s] Color_adjustment color_adjustment_2.0:  83%|████████▎ | 83/100 [00:00<00:00, 411.41it/s]                                                                                         
正在应用变换: adding_noise (每次增加10的噪声强度，范围10到100)
 Adding_noise adding_noise_10:   0%|          | 0/100 [00:00<?, ?it/s] Adding_noise adding_noise_10:  52%|█████▏    | 52/100 [00:00<00:00, 512.83it/s]                                                                                 Adding_noise adding_noise_20:   0%|          | 0/100 [00:00<?, ?it/s] Adding_noise adding_noise_20:  53%|█████▎    | 53/100 [00:00<00:00, 528.29it/s]                                                                                 Adding_noise adding_noise_30:   0%|          | 0/100 [00:00<?, ?it/s] Adding_noise adding_noise_30:  59%|█████▉    | 59/100 [00:00<00:00, 580.29it/s]                                                                                 Adding_noise adding_noise_40:   0%|          | 0/100 [00:00<?, ?it/s] Adding_noise adding_noise_40:  60%|██████    | 60/100 [00:00<00:00, 597.61it/s]                                                                                 Adding_noise adding_noise_50:   0%|          | 0/100 [00:00<?, ?it/s] Adding_noise adding_noise_50:  61%|██████    | 61/100 [00:00<00:00, 601.37it/s]                                                                                 Adding_noise adding_noise_60:   0%|          | 0/100 [00:00<?, ?it/s] Adding_noise adding_noise_60:  60%|██████    | 60/100 [00:00<00:00, 597.08it/s]                                                                                 Adding_noise adding_noise_70:   0%|          | 0/100 [00:00<?, ?it/s] Adding_noise adding_noise_70:  66%|██████▌   | 66/100 [00:00<00:00, 651.14it/s]                                                                                 Adding_noise adding_noise_80:   0%|          | 0/100 [00:00<?, ?it/s] Adding_noise adding_noise_80:  65%|██████▌   | 65/100 [00:00<00:00, 644.43it/s]                                                                                 Adding_noise adding_noise_90:   0%|          | 0/100 [00:00<?, ?it/s] Adding_noise adding_noise_90:  62%|██████▏   | 62/100 [00:00<00:00, 616.50it/s]                                                                                 Adding_noise adding_noise_100:   0%|          | 0/100 [00:00<?, ?it/s] Adding_noise adding_noise_100:  65%|██████▌   | 65/100 [00:00<00:00, 642.56it/s]                                                                                 
正在应用变换: mirroring (包括水平镜像和垂直镜像)
 Mirroring horizontal_flip:   0%|          | 0/100 [00:00<?, ?it/s] Mirroring horizontal_flip:  35%|███▌      | 35/100 [00:00<00:00, 344.29it/s] Mirroring horizontal_flip:  75%|███████▌  | 75/100 [00:00<00:00, 372.34it/s]                                                                              Mirroring vertical_flip:   0%|          | 0/100 [00:00<?, ?it/s] Mirroring vertical_flip:  35%|███▌      | 35/100 [00:00<00:00, 348.62it/s] Mirroring vertical_flip:  76%|███████▌  | 76/100 [00:00<00:00, 378.47it/s]                                                                           
所有变换已成功应用并保存。
[Done] 六种变换处理完成。

2025-05-26 23:40:51,173 - INFO - 命令执行成功: python XRID.py --transform_dir ./original_dataset
2025-05-26 23:40:51,173 - INFO - 开始执行命令: python XRID.py --original_dir ./original_dataset, cwd=XRID
Some weights of ViTModel were not initialized from the model checkpoint at google/vit-base-patch16-224 and are newly initialized: ['vit.pooler.dense.bias', 'vit.pooler.dense.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[Step] 对 ./original_dataset 执行特征提取与相似度计算(情况1)...
[feature_extraction] Running on device=mps
[Step] 加载模型 (DINO, ViT, BLIP2)...
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  3.07it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  4.72it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  4.37it/s]
/Users/dylan/.pyenv/versions/dl_env/lib/python3.11/site-packages/torch/nn/functional.py:4594: UserWarning: The operator 'aten::upsample_bicubic2d.out' is not currently supported on the MPS backend and will fall back to run on the CPU. This may have performance implications. (Triggered internally at /Users/runner/work/pytorch/pytorch/pytorch/aten/src/ATen/mps/MPSFallback.mm:13.)
  return torch._C._nn.upsample_bicubic2d(

[Compare] transform=cropping, step=cropping_30
Traceback (most recent call last):
  File "/Users/dylan/Code_Projects/Python_Projects/image_similarity/my_agent_project/XRID/XRID.py", line 71, in <module>
    main()
  File "/Users/dylan/Code_Projects/Python_Projects/image_similarity/my_agent_project/XRID/XRID.py", line 62, in main
    feature_extraction.run_feature_comparison(args.original_dir)
  File "/Users/dylan/Code_Projects/Python_Projects/image_similarity/my_agent_project/XRID/feature_extraction.py", line 439, in run_feature_comparison
    feat = extract_feature_blip2(blip2_model, blip2_preprocess, path, device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dylan/Code_Projects/Python_Projects/image_similarity/my_agent_project/XRID/feature_extraction.py", line 75, in extract_feature_blip2
    inputs = preprocess(pil_image, return_tensors="pt").to(device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dylan/.pyenv/versions/dl_env/lib/python3.11/site-packages/transformers/models/blip_2/processing_blip_2.py", line 165, in __call__
    image_encoding = self.image_processor(images, **output_kwargs["images_kwargs"])
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dylan/.pyenv/versions/dl_env/lib/python3.11/site-packages/transformers/image_processing_utils.py", line 41, in __call__
    return self.preprocess(images, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dylan/.pyenv/versions/dl_env/lib/python3.11/site-packages/transformers/utils/generic.py", line 852, in wrapper
    return func(*args, **valid_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dylan/.pyenv/versions/dl_env/lib/python3.11/site-packages/transformers/models/blip/image_processing_blip.py", line 277, in preprocess
    images = [
             ^
  File "/Users/dylan/.pyenv/versions/dl_env/lib/python3.11/site-packages/transformers/models/blip/image_processing_blip.py", line 278, in <listcomp>
    self.rescale(image=image, scale=rescale_factor, input_data_format=input_data_format)
  File "/Users/dylan/.pyenv/versions/dl_env/lib/python3.11/site-packages/transformers/image_processing_utils.py", line 76, in rescale
    return rescale(image, scale=scale, data_format=data_format, input_data_format=input_data_format, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dylan/.pyenv/versions/dl_env/lib/python3.11/site-packages/transformers/image_transforms.py", line 129, in rescale
    rescaled_image = image.astype(np.float64) * scale  # Numpy type promotion has changed, so always upcast first
                     ^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
tokenIdA=1 与 tokenIdB=2 都在售(Listed).
等待 0x9965507d1a55bcc2695c58ba16fb37d819b0a4dc -> 0x70997970C51812dc3A010C7d01b50e0d17dc79C8 2.0 ETH 转账...
在区块 17 找到匹配交易, hash=e2a58c6527b739b1e29a083bd459f02efa158b49df4fe450529827f16f503b1e
已检测到 您->Agent 2.0 ETH, txHash=b"\xe2\xa5\x8ce'\xb79\xb1\xe2\x9a\x08;\xd4Y\xf0.\xfa\x15\x8bI\xdfO\xe4PR\x98'\xf1oP;\x1e"
originalTokenId=1, suspicionTokenId=2
=== 以Agent informerDeposit(informer=0x9965507d1a55bcc2695c58ba16fb37d819b0a4dc, original=1, suspicion=2, 2ETH) ===
informerDeposit 交易哈希: 9ad22f2cb0ea492e3cf735ec74ac81383e622d2f9f4d934238b350eef59368ba
InformerDeposited => informer=0x9965507D1a55bcC2695C58ba16FB37d819B0A4dc, original=1, suspicion=2, amount=2 ETH
举报保证金提交成功! 接下来进行转售检测...

===== 开始下载 & 检测 originalTokenId / suspicionTokenId =====
tokenId=1, tokenURI=http://127.0.0.1:8080/ipfs/QmcRFhUuPugSr8Ct4LYmi3a76v6g1iSrQqtL2hvwcidg8K
解密得到 raw_cid=Qmdf1q4XorJmixhNAioH1EYVposcno5XbUH53aed6nDNu1
已下载到 ../my_agent_project/XRID/original_dataset.zip
当前目录: /Users/dylan/Code_Projects/Python_Projects/image_similarity/python_call_contract
解压完成 => ../my_agent_project/XRID/original_dataset
已删除: ../my_agent_project/XRID/original_dataset/__MACOSX
已移动并删除子文件夹: ../my_agent_project/XRID/original_dataset/stl-10-airplane
tokenId=2, tokenURI=http://127.0.0.1:8080/ipfs/QmNy2Y85hmu8V5rS2Bojt8ad9Nc7QrRZUPiBsW6h5HHcG6
解密得到 raw_cid=QmSPw6BTYXTmkNaputUSbTQyFFaCLZFCRQSzrmnpFErizq
已下载到 ../my_agent_project/XRID/suspicion_dataset.zip
当前目录: /Users/dylan/Code_Projects/Python_Projects/image_similarity/python_call_contract
解压完成 => ../my_agent_project/XRID/suspicion_dataset
已删除: ../my_agent_project/XRID/suspicion_dataset/__MACOSX
已移动并删除子文件夹: ../my_agent_project/XRID/suspicion_dataset/resale-stl-10-airplane
Traceback (most recent call last):
  File "/Users/dylan/Code_Projects/Python_Projects/image_similarity/python_call_contract/../python_call_contract/function_7_informer.py", line 374, in <module>
    main()
  File "/Users/dylan/Code_Projects/Python_Projects/image_similarity/python_call_contract/../python_call_contract/function_7_informer.py", line 369, in main
    run_xrid_check(original_id, suspicion_id, jinx_addr)
  File "/Users/dylan/Code_Projects/Python_Projects/image_similarity/python_call_contract/../python_call_contract/function_7_informer.py", line 242, in run_xrid_check
    run_xrid_commands("original_dataset", "suspicion_dataset")
  File "/Users/dylan/Code_Projects/Python_Projects/image_similarity/python_call_contract/../my_agent_project/features/feature_resale.py", line 39, in run_xrid_commands
    subprocess.run(cmd, check=True, cwd=cwd_path)
  File "/Users/dylan/.pyenv/versions/3.11.5/lib/python3.11/subprocess.py", line 550, in run
    stdout, stderr = process.communicate(input, timeout=timeout)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dylan/.pyenv/versions/3.11.5/lib/python3.11/subprocess.py", line 1201, in communicate
    self.wait()
  File "/Users/dylan/.pyenv/versions/3.11.5/lib/python3.11/subprocess.py", line 1264, in wait
    return self._wait(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dylan/.pyenv/versions/3.11.5/lib/python3.11/subprocess.py", line 2046, in _wait
    (pid, sts) = self._try_wait(0)
                 ^^^^^^^^^^^^^^^^^
  File "/Users/dylan/.pyenv/versions/3.11.5/lib/python3.11/subprocess.py", line 2004, in _try_wait
    (pid, sts) = os.waitpid(self.pid, wait_flags)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
