

===== 新购买流程开始: 2025-04-30 09:29:30 =====
tokenId=1, buyerAddr=0x90f79bf6eb2c4f870365e785982e1f101e93b906
Check listing 输出:
ListingStatus=Listed, price=1
metadataURL=http://127.0.0.1:8080/ipfs/QmSFJ36fdoMZp8Kv9XsGWB6Jya3Hd1rkTzj8aUkwjtMvJQ
请求转账: 1.0 ETH 到 0x70997970C51812dc3A010C7d01b50e0d17dc79C8
在历史区块 18 找到匹配交易，hash=857301b4a3159421187c2fceaa928f451596e576d9900c6ddf5d753a059e449c
加密的 zip_cid=HIhJKD71Gj1U4ASFf5T0cQDTlu8nROghFK0kaoHy5G5BiIZUHVgxy1vKslobn2HDeJdp72hqfQPkhae2oy2xp1bGh/KBY4gdCRi6WaETF4qa1+e8CrgnxjfN+rNC+ZPf5Sr9XqDlEP/CWVQOe6vzLt72+8gkIJs4jEZ2hJqJoziZOIOv+7Bpn4Xkjt3sw8/fPp3hNMe/B5YXMUBaPnXIws6Tu30N1VUcRdVuuliXBqGm5xhdfGSxbcr7UJcC4FtYqI9gVak3/mX3AoJBYZf+qclanGv41byGUriVlWTHr9b02wNkHMw6DlXubSirRl2z1igqkedZH/jWWk6PQTxGSw==
解密脚本输出:
Decrypted CID: Qmdf1q4XorJmixhNAioH1EYVposcno5XbUH53aed6nDNu1
已成功下载: CID=Qmdf1q4XorJmixhNAioH1EYVposcno5XbUH53aed6nDNu1 => /Users/dylan/Code_Projects/Python_Projects/image_similarity/my_agent_project/features/../data/dataset.zip
水印生成完毕，已生成 dataset_watermark.zip
[uploadForBuyer]输出:
开始执行 uploadForBuyer.js 脚本
使用公钥路径: /Users/dylan/Code_Projects/Python_Projects/image_similarity/my_agent_project/temp_public_key.pem
成功读取公钥，长度为 450 字符
尝试读取的数据集路径: /Users/dylan/Code_Projects/Python_Projects/image_similarity/my_agent_project/data/dataset_watermark.zip
找到水印数据集文件，大小为 1196686 字节
正在准备连接IPFS...
成功连接到IPFS API
正在读取水印数据集文件...
上传数据集到IPFS (大小: 1196686 字节)...
数据集上传成功，CID: Qmd4DX5xHEMfsAaEgHQmLRzFuC6z4LSsoanQmWqdqbJZGy
使用买家公钥加密CID...
准备加密数据: Qmd4DX5xHEMfsAaEgHQmLRzFuC6z4LSsoanQmWqdqbJZGy
加密成功，结果长度: 344 字符

===== Final Output =====
rawCid=Qmd4DX5xHEMfsAaEgHQmLRzFuC6z4LSsoanQmWqdqbJZGy
encryptedCid=Ax3ztXCZaNI0hnvn5XRiUufRxsJH4pBZsxqa79PM91lmdWeo7O2QT4gMQxytpdYPYAhEwWcHdCaeoPqao5RhV7KaM/6pc+yeQDHQ96lsVVws+TTEMXfKClWYpXL2jMalsaHm9hkzD2NKLbV4UHxHVeYiKLKfsGZLtfKOjTmzEO31VO0hjCFuvfp2aLlvsW11OlLsfrev7FVhEntvyS/ZFIDmhqzIUcGqhzI1EOl6mHU4zKBidVjzkPlOgOqT9bwzrLgRAcmPjTiz3t7857fKHgLVDldOeUb7PIguFtLKF6Z6YB1cndc2vhaOAGpGCr0XtbaOdSLvpKx/Kt2tvM0muw==
成功加密并上传, encryptedCid = Ax3ztXCZaNI0hnvn5XRiUufRxsJH4pBZsxqa79PM91lmdWeo7O2QT4gMQxytpdYPYAhEwWcHdCaeoPqao5RhV7KaM/6pc+yeQDHQ96lsVVws+TTEMXfKClWYpXL2jMalsaHm9hkzD2NKLbV4UHxHVeYiKLKfsGZLtfKOjTmzEO31VO0hjCFuvfp2aLlvsW11OlLsfrev7FVhEntvyS/ZFIDmhqzIUcGqhzI1EOl6mHU4zKBidVjzkPlOgOqT9bwzrLgRAcmPjTiz3t7857fKHgLVDldOeUb7PIguFtLKF6Z6YB1cndc2vhaOAGpGCr0XtbaOdSLvpKx/Kt2tvM0muw==
购买输出: 开始轮询区块，查找 bob->0x70997970C51812dc3A010C7d01b50e0d17dc79C8 转账金额=1000000000000000000 wei
在区块 18 找到匹配交易,hash=857301b4a3159421187c2fceaa928f451596e576d9900c6ddf5d753a059e449c
确认收到来自 0x90F79bf6EB2c4f870365E785982E1f101E93b906 的付款, 交易hash=857301b4a3159421187c2fceaa928f451596e576d9900c6ddf5d753a059e449c

=== 调用 purchaseNFT(tokenId=1, buyer=0x90F79bf6EB2c4f870365E785982E1f101E93b906, encCid=...) ===
purchaseNFT 交易哈希: 016c92c44c510a0e959a671881adee9b777f8a9854d23b77374311d577372611
NFTPurchased => operator=0x70997970C51812dc3A010C7d01b50e0d17dc79C8, tokenId=1, dataOwner=0x3C44CdDdB6a900fa2b585dd299e03d12FA4293BC, ethPaid=1 ETH, encCid=Ax3ztXCZaNI0hnvn5XRiUufRxsJH4pBZsxqa79PM91lmdWeo7O2QT4gMQxytpdYPYAhEwWcHdCaeoPqao5RhV7KaM/6pc+yeQDHQ96lsVVws+TTEMXfKClWYpXL2jMalsaHm9hkzD2NKLbV4UHxHVeYiKLKfsGZLtfKOjTmzEO31VO0hjCFuvfp2aLlvsW11OlLsfrev7FVhEntvyS/ZFIDmhqzIUcGqhzI1EOl6mHU4zKBidVjzkPlOgOqT9bwzrLgRAcmPjTiz3t7857fKHgLVDldOeUb7PIguFtLKF6Z6YB1cndc2vhaOAGpGCr0XtbaOdSLvpKx/Kt2tvM0muw==

 [92m=== purchaseNFT 成功, 您已获得访问权. ===[0m
===== 购买流程成功完成 =====
最终加密CID: Ax3ztXCZaNI0hnvn5XRiUufRxsJH4pBZsxqa79PM91lmdWeo7O2QT4gMQxytpdYPYAhEwWcHdCaeoPqao5RhV7KaM/6pc+yeQDHQ96lsVVws+TTEMXfKClWYpXL2jMalsaHm9hkzD2NKLbV4UHxHVeYiKLKfsGZLtfKOjTmzEO31VO0hjCFuvfp2aLlvsW11OlLsfrev7FVhEntvyS/ZFIDmhqzIUcGqhzI1EOl6mHU4zKBidVjzkPlOgOqT9bwzrLgRAcmPjTiz3t7857fKHgLVDldOeUb7PIguFtLKF6Z6YB1cndc2vhaOAGpGCr0XtbaOdSLvpKx/Kt2tvM0muw==


===== 新购买流程开始: 2025-05-23 16:11:38 =====
tokenId=1, buyerAddr=0x90f79bf6eb2c4f870365e785982e1f101e93b906
Check listing 输出:
ListingStatus=Listed, price=1
metadataURL=http://127.0.0.1:8080/ipfs/Qme9AYL9az3UcbnynmeZDv7NgKWBwXHuKNwkdBeci3Wyxm
请求转账: 1.0 ETH 到 0x70997970C51812dc3A010C7d01b50e0d17dc79C8
在历史区块 12 找到匹配交易，hash=0974d35b01950295e20a5b476d7200baa6291202f6cc0c198886c00287d52f4e
加密的 zip_cid=kHMC7jzAcPQgzh9hspSI09KhpbMIcRfMRCnVUDFL+nf/eOmFwnBbHQO79q9/jpyZrU++bXuc92DpvMjQpeqG9Bt5lkwBHA6tAj9DKMDchGhPH7UJZk1X6zPdglT1cI2ThW2D4+pLoCG/sclYREF8lB6yqMF/E+qN8SIoqqADTVmYZfaIvrc8IDIPbTiNOWhA/YCDePjEg2wsN3KQD5hkJeF6Nag4k/qTECTuJEGyATrkIyAOl/3uH7TvGhjj4eZVMkJNjUxuVETgXELFTYaxkI3xFF0QAha+AtsTrxTo76Ow+0bx7lvnicCwZ3Khpmw6hfZUcwmfILaMZlFDyBfDdw==
解密脚本输出:
Decrypted CID: Qmdf1q4XorJmixhNAioH1EYVposcno5XbUH53aed6nDNu1
已成功下载: CID=Qmdf1q4XorJmixhNAioH1EYVposcno5XbUH53aed6nDNu1 => /Users/dylan/Code_Projects/Python_Projects/image_similarity/my_agent_project/features/../data/dataset.zip
水印生成完毕，已生成 dataset_watermark.zip
[uploadForBuyer]输出:
开始执行 uploadForBuyer.js 脚本
使用公钥路径: /Users/dylan/Code_Projects/Python_Projects/image_similarity/my_agent_project/temp_public_key.pem
成功读取公钥，长度为 450 字符
尝试读取的数据集路径: /Users/dylan/Code_Projects/Python_Projects/image_similarity/my_agent_project/data/dataset_watermark.zip
找到水印数据集文件，大小为 1197394 字节
正在准备连接IPFS...
成功连接到IPFS API
正在读取水印数据集文件...
上传数据集到IPFS (大小: 1197394 字节)...
数据集上传成功，CID: QmbtpwBmMhTGJZLfvM7m2VPTv6FQgPzCEa4LwHczjP7QV4
使用买家公钥加密CID...
准备加密数据: QmbtpwBmMhTGJZLfvM7m2VPTv6FQgPzCEa4LwHczjP7QV4
加密成功，结果长度: 344 字符

===== Final Output =====
rawCid=QmbtpwBmMhTGJZLfvM7m2VPTv6FQgPzCEa4LwHczjP7QV4
encryptedCid=ghdg6vqJnBIbVAM84BwW5ocLwqBsiDqv0ICYWlld97szMlrrAwNIDB6V7JPi/pK25eb52bgNa/moqJ5Dkw+c7//Fjm0a4qPuEBAl/i+NGvjNhAjApboy2WVq3n/Yu4GaCSkKSMipby3SZ7pViDG/gOBj3BNl5sVTct/ZD/xySh5FVKKHuqTA6lPnc1Bqm1HE1JS04rh9P3SxTXzC5XXnxpfvMSpEZb2rWExf8pCzC5cIgXcvqIpg8GUsiJANbI1yuK+mu4c0E2t+17andXxMUXLdN3mMaNLaiUC3vvvCVNRJI7Gz9Hrv3ISWp1/rGufNXoWBP6rgnhceyoxacL7coQ==
成功加密并上传, encryptedCid = ghdg6vqJnBIbVAM84BwW5ocLwqBsiDqv0ICYWlld97szMlrrAwNIDB6V7JPi/pK25eb52bgNa/moqJ5Dkw+c7//Fjm0a4qPuEBAl/i+NGvjNhAjApboy2WVq3n/Yu4GaCSkKSMipby3SZ7pViDG/gOBj3BNl5sVTct/ZD/xySh5FVKKHuqTA6lPnc1Bqm1HE1JS04rh9P3SxTXzC5XXnxpfvMSpEZb2rWExf8pCzC5cIgXcvqIpg8GUsiJANbI1yuK+mu4c0E2t+17andXxMUXLdN3mMaNLaiUC3vvvCVNRJI7Gz9Hrv3ISWp1/rGufNXoWBP6rgnhceyoxacL7coQ==
购买输出: 开始轮询区块，查找 bob->0x70997970C51812dc3A010C7d01b50e0d17dc79C8 转账金额=1000000000000000000 wei
在区块 12 找到匹配交易,hash=0974d35b01950295e20a5b476d7200baa6291202f6cc0c198886c00287d52f4e
确认收到来自 0x90F79bf6EB2c4f870365E785982E1f101E93b906 的付款, 交易hash=0974d35b01950295e20a5b476d7200baa6291202f6cc0c198886c00287d52f4e

=== 调用 purchaseNFT(tokenId=1, buyer=0x90F79bf6EB2c4f870365E785982E1f101E93b906, encCid=...) ===
purchaseNFT 交易哈希: be35d302a956a070b8a4b9c9ace4a27ddb8e18368c74450f1283e1918727a41e
NFTPurchased => operator=0x70997970C51812dc3A010C7d01b50e0d17dc79C8, tokenId=1, dataOwner=0x3C44CdDdB6a900fa2b585dd299e03d12FA4293BC, ethPaid=1 ETH, encCid=ghdg6vqJnBIbVAM84BwW5ocLwqBsiDqv0ICYWlld97szMlrrAwNIDB6V7JPi/pK25eb52bgNa/moqJ5Dkw+c7//Fjm0a4qPuEBAl/i+NGvjNhAjApboy2WVq3n/Yu4GaCSkKSMipby3SZ7pViDG/gOBj3BNl5sVTct/ZD/xySh5FVKKHuqTA6lPnc1Bqm1HE1JS04rh9P3SxTXzC5XXnxpfvMSpEZb2rWExf8pCzC5cIgXcvqIpg8GUsiJANbI1yuK+mu4c0E2t+17andXxMUXLdN3mMaNLaiUC3vvvCVNRJI7Gz9Hrv3ISWp1/rGufNXoWBP6rgnhceyoxacL7coQ==

 [92m=== purchaseNFT 成功, 您已获得访问权. ===[0m
===== 购买流程成功完成 =====
最终加密CID: ghdg6vqJnBIbVAM84BwW5ocLwqBsiDqv0ICYWlld97szMlrrAwNIDB6V7JPi/pK25eb52bgNa/moqJ5Dkw+c7//Fjm0a4qPuEBAl/i+NGvjNhAjApboy2WVq3n/Yu4GaCSkKSMipby3SZ7pViDG/gOBj3BNl5sVTct/ZD/xySh5FVKKHuqTA6lPnc1Bqm1HE1JS04rh9P3SxTXzC5XXnxpfvMSpEZb2rWExf8pCzC5cIgXcvqIpg8GUsiJANbI1yuK+mu4c0E2t+17andXxMUXLdN3mMaNLaiUC3vvvCVNRJI7Gz9Hrv3ISWp1/rGufNXoWBP6rgnhceyoxacL7coQ==


===== 新购买流程开始: 2025-05-26 23:33:37 =====
tokenId=1, buyerAddr=0x90f79bf6eb2c4f870365e785982e1f101e93b906
Check listing 输出:
ListingStatus=Listed, price=1
metadataURL=http://127.0.0.1:8080/ipfs/QmcRFhUuPugSr8Ct4LYmi3a76v6g1iSrQqtL2hvwcidg8K
请求转账: 1.0 ETH 到 0x70997970C51812dc3A010C7d01b50e0d17dc79C8
在历史区块 12 找到匹配交易，hash=e36d2ba44af2c5903be4f8e35e38f3e2658cc1e7bc8abc4f029170b9183c4722
加密的 zip_cid=lf7D6I6UJaUhRHT4AAipmD3py8a2MDlHlLC0F5OQgt8ZQnvlEfSrOFHAF2EmtScMo/V0CX95EIKq46gQQrP6UItam9As0hEsJy92HP9cmN1Yd2RczwMPIbPkSqXZyZq9Avn70k67dbn/H97CF/26im3TUWUiHZXplk9IxdQZqGfKjXRmWq5lQq854voKjU6egHioNkoA86rDD4qaq+qxHv9a3wMSvP8QINTSwz83DpMywIdQoOOjt6XfR3h5kJ4fMOWgsXYUHNPf/M6iQDAJHSlYqYIFkMqcT9LNiy66fcr4ioB6PqVC91JiVX+XMO5o/73AmkkMUmobPtNIfzfy1A==
解密脚本输出:
Decrypted CID: Qmdf1q4XorJmixhNAioH1EYVposcno5XbUH53aed6nDNu1
已成功下载: CID=Qmdf1q4XorJmixhNAioH1EYVposcno5XbUH53aed6nDNu1 => /Users/dylan/Code_Projects/Python_Projects/image_similarity/my_agent_project/features/../data/dataset.zip
水印生成完毕，已生成 dataset_watermark.zip
[uploadForBuyer]输出:
开始执行 uploadForBuyer.js 脚本
使用公钥路径: /Users/dylan/Code_Projects/Python_Projects/image_similarity/my_agent_project/temp_public_key.pem
成功读取公钥，长度为 450 字符
尝试读取的数据集路径: /Users/dylan/Code_Projects/Python_Projects/image_similarity/my_agent_project/data/dataset_watermark.zip
找到水印数据集文件，大小为 1198767 字节
正在准备连接IPFS...
成功连接到IPFS API
正在读取水印数据集文件...
上传数据集到IPFS (大小: 1198767 字节)...
数据集上传成功，CID: QmZc7q4VhCBN8qfUZq1rxvei8a7NjGf1DAQXJ4GgWRL9DM
使用买家公钥加密CID...
准备加密数据: QmZc7q4VhCBN8qfUZq1rxvei8a7NjGf1DAQXJ4GgWRL9DM
加密成功，结果长度: 344 字符

===== Final Output =====
rawCid=QmZc7q4VhCBN8qfUZq1rxvei8a7NjGf1DAQXJ4GgWRL9DM
encryptedCid=Ff6qs6Ygr2MpFoaxZb5FV60bp/3Duggg7TVbXwlUPyuJwM1r2c8LszHnHNx71kJRmZpoJ7xjq8fjW09Qk4VR2kiB3R016XeE/QPVzxGhsd583biYFy7XF95E999TI4BWb/2fiPjHMRUlXsu4+FKdk5iZzW918JYU1/U/6YSzMEutfVXUCYqzxPOWxVT/46i2agJpsltQMJb6CwVpP0CxGpQFOdxrPTWsGCpgSU5eopv5jnSCwncuwbvEa5kMQfEj7SsLXYt0ES6XjmoKj+lpbehe8xYdlaAVsek7S+XYWPyoSICeVOanrQR6V1sGKZH2uSxBgzNM9kBZ3yp8NUXwuQ==
成功加密并上传, encryptedCid = Ff6qs6Ygr2MpFoaxZb5FV60bp/3Duggg7TVbXwlUPyuJwM1r2c8LszHnHNx71kJRmZpoJ7xjq8fjW09Qk4VR2kiB3R016XeE/QPVzxGhsd583biYFy7XF95E999TI4BWb/2fiPjHMRUlXsu4+FKdk5iZzW918JYU1/U/6YSzMEutfVXUCYqzxPOWxVT/46i2agJpsltQMJb6CwVpP0CxGpQFOdxrPTWsGCpgSU5eopv5jnSCwncuwbvEa5kMQfEj7SsLXYt0ES6XjmoKj+lpbehe8xYdlaAVsek7S+XYWPyoSICeVOanrQR6V1sGKZH2uSxBgzNM9kBZ3yp8NUXwuQ==
购买输出: 开始轮询区块，查找 bob->0x70997970C51812dc3A010C7d01b50e0d17dc79C8 转账金额=1000000000000000000 wei
在区块 12 找到匹配交易,hash=e36d2ba44af2c5903be4f8e35e38f3e2658cc1e7bc8abc4f029170b9183c4722
确认收到来自 0x90F79bf6EB2c4f870365E785982E1f101E93b906 的付款, 交易hash=e36d2ba44af2c5903be4f8e35e38f3e2658cc1e7bc8abc4f029170b9183c4722

=== 调用 purchaseNFT(tokenId=1, buyer=0x90F79bf6EB2c4f870365E785982E1f101E93b906, encCid=...) ===
purchaseNFT 交易哈希: b2ebd14f82ac4cfaf48cc2da057968b8322f03f5c30deb8b8148eadeb1356831
NFTPurchased => operator=0x70997970C51812dc3A010C7d01b50e0d17dc79C8, tokenId=1, dataOwner=0x15d34AAf54267DB7D7c367839AAf71A00a2C6A65, ethPaid=1 ETH, encCid=Ff6qs6Ygr2MpFoaxZb5FV60bp/3Duggg7TVbXwlUPyuJwM1r2c8LszHnHNx71kJRmZpoJ7xjq8fjW09Qk4VR2kiB3R016XeE/QPVzxGhsd583biYFy7XF95E999TI4BWb/2fiPjHMRUlXsu4+FKdk5iZzW918JYU1/U/6YSzMEutfVXUCYqzxPOWxVT/46i2agJpsltQMJb6CwVpP0CxGpQFOdxrPTWsGCpgSU5eopv5jnSCwncuwbvEa5kMQfEj7SsLXYt0ES6XjmoKj+lpbehe8xYdlaAVsek7S+XYWPyoSICeVOanrQR6V1sGKZH2uSxBgzNM9kBZ3yp8NUXwuQ==

 [92m=== purchaseNFT 成功, 您已获得访问权. ===[0m
===== 购买流程成功完成 =====
最终加密CID: Ff6qs6Ygr2MpFoaxZb5FV60bp/3Duggg7TVbXwlUPyuJwM1r2c8LszHnHNx71kJRmZpoJ7xjq8fjW09Qk4VR2kiB3R016XeE/QPVzxGhsd583biYFy7XF95E999TI4BWb/2fiPjHMRUlXsu4+FKdk5iZzW918JYU1/U/6YSzMEutfVXUCYqzxPOWxVT/46i2agJpsltQMJb6CwVpP0CxGpQFOdxrPTWsGCpgSU5eopv5jnSCwncuwbvEa5kMQfEj7SsLXYt0ES6XjmoKj+lpbehe8xYdlaAVsek7S+XYWPyoSICeVOanrQR6V1sGKZH2uSxBgzNM9kBZ3yp8NUXwuQ==


===== 新购买流程开始: 2025-05-27 11:13:35 =====
tokenId=2, buyerAddr=0x9965507d1a55bcc2695c58ba16fb37d819b0a4dc
Check listing 输出:
ListingStatus=Listed, price=1
metadataURL=http://127.0.0.1:8080/ipfs/QmNy2Y85hmu8V5rS2Bojt8ad9Nc7QrRZUPiBsW6h5HHcG6
请求转账: 1.0 ETH 到 0x70997970C51812dc3A010C7d01b50e0d17dc79C8
在历史区块 17 找到匹配交易，hash=e2a58c6527b739b1e29a083bd459f02efa158b49df4fe450529827f16f503b1e
加密的 zip_cid=o5S510cL8HdcQPeyvZHl0+2a9TFftbiOwKIRY2jrhEgGGXveU504q8LNFrDqu9nMpw59Q1vJWPqm7fralwD6UaVAH2tfGYPRGo5V3qrWwsdgE9w0fVbc/uW980/B8wJtCWbPiuEle4szRdFmT+lzraThmepQ50+ycSETk+VSkTEQCwW4fEV8rD5z9r9+ZKJZBo7oQWOfSkyoB3lW3YsN510dMNBunYjz7J1t89is6w3a4Vfd7Ib5NC+SvJkn/vu4foOEYsuHrr+20v53sTBGJriwrsKseEsly9+N5q2lKMH+KhbViA5NzvTNd6uB7OTu38rBMtoy2niaQuadMm1DOw==
解密脚本输出:
Decrypted CID: QmSPw6BTYXTmkNaputUSbTQyFFaCLZFCRQSzrmnpFErizq
已成功下载: CID=QmSPw6BTYXTmkNaputUSbTQyFFaCLZFCRQSzrmnpFErizq => /Users/dylan/Code_Projects/Python_Projects/image_similarity/my_agent_project/features/../data/dataset.zip
水印生成完毕，已生成 dataset_watermark.zip
[uploadForBuyer]输出:
开始执行 uploadForBuyer.js 脚本
使用公钥路径: /Users/dylan/Code_Projects/Python_Projects/image_similarity/my_agent_project/temp_public_key.pem
成功读取公钥，长度为 450 字符
尝试读取的数据集路径: /Users/dylan/Code_Projects/Python_Projects/image_similarity/my_agent_project/data/dataset_watermark.zip
找到水印数据集文件，大小为 1328520 字节
正在准备连接IPFS...
成功连接到IPFS API
正在读取水印数据集文件...
上传数据集到IPFS (大小: 1328520 字节)...
数据集上传成功，CID: QmXsrqxRwcjvBqVx4fXxDa1K8wxo5ZmsWV2PEdY3Mt2rM2
使用买家公钥加密CID...
准备加密数据: QmXsrqxRwcjvBqVx4fXxDa1K8wxo5ZmsWV2PEdY3Mt2rM2
加密成功，结果长度: 344 字符

===== Final Output =====
rawCid=QmXsrqxRwcjvBqVx4fXxDa1K8wxo5ZmsWV2PEdY3Mt2rM2
encryptedCid=YDbp1zsN/6F7JsOpxOZz0/8XdW3z43L99sm3u3MlhwzfSxtLPlLeOk69/NuT4DwPa2N5dIciyYldx0ncOQPK75w02GGUU0QgOY5F9CY131+uS2PZA7FAck88KMyZhqU+HFToxUeXzblW2RL3sSMJ+7vEEi2NjCfXQWGDFmf3WAXD2r+TBulQlWYUsQY9f9GRRHGsEupWInMHuFZfkKB0GV+HZJySj3bDoNNGWd/Gu5nPZcRxFDxUUnNtefI3tKvY1Sh1ZYcMGTSQuIavrohnJcBZX5lpkRQuNwzx2xa+lCgTnV3MjURBQH8D//Drc9mZL7JjVOwsk4V4dmenf40FzA==
成功加密并上传, encryptedCid = YDbp1zsN/6F7JsOpxOZz0/8XdW3z43L99sm3u3MlhwzfSxtLPlLeOk69/NuT4DwPa2N5dIciyYldx0ncOQPK75w02GGUU0QgOY5F9CY131+uS2PZA7FAck88KMyZhqU+HFToxUeXzblW2RL3sSMJ+7vEEi2NjCfXQWGDFmf3WAXD2r+TBulQlWYUsQY9f9GRRHGsEupWInMHuFZfkKB0GV+HZJySj3bDoNNGWd/Gu5nPZcRxFDxUUnNtefI3tKvY1Sh1ZYcMGTSQuIavrohnJcBZX5lpkRQuNwzx2xa+lCgTnV3MjURBQH8D//Drc9mZL7JjVOwsk4V4dmenf40FzA==
购买输出: 开始轮询区块，查找 bob->0x70997970C51812dc3A010C7d01b50e0d17dc79C8 转账金额=1000000000000000000 wei
在区块 26 找到匹配交易,hash=c4fb07314a648bfd06cf438db1be942d2ed6ce042ba57f255a70ad46fc35a198
确认收到来自 0x9965507D1a55bcC2695C58ba16FB37d819B0A4dc 的付款, 交易hash=c4fb07314a648bfd06cf438db1be942d2ed6ce042ba57f255a70ad46fc35a198

=== 调用 purchaseNFT(tokenId=2, buyer=0x9965507D1a55bcC2695C58ba16FB37d819B0A4dc, encCid=...) ===
purchaseNFT 交易哈希: 5f1993299a3a14da30e96023ca0437075057d8732d9a64c6f75cda959e27fc54
NFTPurchased => operator=0x70997970C51812dc3A010C7d01b50e0d17dc79C8, tokenId=2, dataOwner=0x976EA74026E726554dB657fA54763abd0C3a0aa9, ethPaid=1 ETH, encCid=YDbp1zsN/6F7JsOpxOZz0/8XdW3z43L99sm3u3MlhwzfSxtLPlLeOk69/NuT4DwPa2N5dIciyYldx0ncOQPK75w02GGUU0QgOY5F9CY131+uS2PZA7FAck88KMyZhqU+HFToxUeXzblW2RL3sSMJ+7vEEi2NjCfXQWGDFmf3WAXD2r+TBulQlWYUsQY9f9GRRHGsEupWInMHuFZfkKB0GV+HZJySj3bDoNNGWd/Gu5nPZcRxFDxUUnNtefI3tKvY1Sh1ZYcMGTSQuIavrohnJcBZX5lpkRQuNwzx2xa+lCgTnV3MjURBQH8D//Drc9mZL7JjVOwsk4V4dmenf40FzA==

 [92m=== purchaseNFT 成功, 您已获得访问权. ===[0m
===== 购买流程成功完成 =====
最终加密CID: YDbp1zsN/6F7JsOpxOZz0/8XdW3z43L99sm3u3MlhwzfSxtLPlLeOk69/NuT4DwPa2N5dIciyYldx0ncOQPK75w02GGUU0QgOY5F9CY131+uS2PZA7FAck88KMyZhqU+HFToxUeXzblW2RL3sSMJ+7vEEi2NjCfXQWGDFmf3WAXD2r+TBulQlWYUsQY9f9GRRHGsEupWInMHuFZfkKB0GV+HZJySj3bDoNNGWd/Gu5nPZcRxFDxUUnNtefI3tKvY1Sh1ZYcMGTSQuIavrohnJcBZX5lpkRQuNwzx2xa+lCgTnV3MjURBQH8D//Drc9mZL7JjVOwsk4V4dmenf40FzA==


===== 新购买流程开始: 2025-05-27 11:23:35 =====
tokenId=2, buyerAddr=0x90f79bf6eb2c4f870365e785982e1f101e93b906
Check listing 输出:
ListingStatus=Listed, price=1
metadataURL=http://127.0.0.1:8080/ipfs/QmNy2Y85hmu8V5rS2Bojt8ad9Nc7QrRZUPiBsW6h5HHcG6
请求转账: 1.0 ETH 到 0x70997970C51812dc3A010C7d01b50e0d17dc79C8
在历史区块 28 找到匹配交易，hash=1c7641bf869835c20b93eb74f88f4b119c9428d8a099dcc2aa367ed3d0f3e3b9
加密的 zip_cid=o5S510cL8HdcQPeyvZHl0+2a9TFftbiOwKIRY2jrhEgGGXveU504q8LNFrDqu9nMpw59Q1vJWPqm7fralwD6UaVAH2tfGYPRGo5V3qrWwsdgE9w0fVbc/uW980/B8wJtCWbPiuEle4szRdFmT+lzraThmepQ50+ycSETk+VSkTEQCwW4fEV8rD5z9r9+ZKJZBo7oQWOfSkyoB3lW3YsN510dMNBunYjz7J1t89is6w3a4Vfd7Ib5NC+SvJkn/vu4foOEYsuHrr+20v53sTBGJriwrsKseEsly9+N5q2lKMH+KhbViA5NzvTNd6uB7OTu38rBMtoy2niaQuadMm1DOw==
解密脚本输出:
Decrypted CID: QmSPw6BTYXTmkNaputUSbTQyFFaCLZFCRQSzrmnpFErizq
已成功下载: CID=QmSPw6BTYXTmkNaputUSbTQyFFaCLZFCRQSzrmnpFErizq => /Users/dylan/Code_Projects/Python_Projects/image_similarity/my_agent_project/features/../data/dataset.zip
水印生成完毕，已生成 dataset_watermark.zip
[uploadForBuyer]输出:
开始执行 uploadForBuyer.js 脚本
使用公钥路径: /Users/dylan/Code_Projects/Python_Projects/image_similarity/my_agent_project/temp_public_key.pem
成功读取公钥，长度为 450 字符
尝试读取的数据集路径: /Users/dylan/Code_Projects/Python_Projects/image_similarity/my_agent_project/data/dataset_watermark.zip
找到水印数据集文件，大小为 1328149 字节
正在准备连接IPFS...
成功连接到IPFS API
正在读取水印数据集文件...
上传数据集到IPFS (大小: 1328149 字节)...
数据集上传成功，CID: QmU41478icdoughpfD4ZVm8xfbh5EsjDR5ChM54FPD2mHo
使用买家公钥加密CID...
准备加密数据: QmU41478icdoughpfD4ZVm8xfbh5EsjDR5ChM54FPD2mHo
加密成功，结果长度: 344 字符

===== Final Output =====
rawCid=QmU41478icdoughpfD4ZVm8xfbh5EsjDR5ChM54FPD2mHo
encryptedCid=fRVVksPSbYFioQkELbElXIvcRVldZx+GIE+NtLC05cC/wlJ0WlqRgIHxQW03K5f2baL/l/OSTDy5zMzBGZl2zVaUb4tCrK97EfelOJAAOxA0gTW+MbCRJ9XzbQhG9GyznI3FOT9cSUsLpn5g+MaF+DslHN681Gczb2FmITYl+Lh7LCGinofAGnErnkI/fBaP77i7HoLNuxvBci3RlAmcgyk5tyWLHsWGvJLYvUylnhRnCLtBP2mtyO0SMXwO5ia11EC/7UgTBZyPAzsFQNffYyFrDaiuVcY6v0U3l/qPfyUultZrHvwqe8WNLP9CrivUGUCFX/Qzs/L9+wQlK2xitQ==
成功加密并上传, encryptedCid = fRVVksPSbYFioQkELbElXIvcRVldZx+GIE+NtLC05cC/wlJ0WlqRgIHxQW03K5f2baL/l/OSTDy5zMzBGZl2zVaUb4tCrK97EfelOJAAOxA0gTW+MbCRJ9XzbQhG9GyznI3FOT9cSUsLpn5g+MaF+DslHN681Gczb2FmITYl+Lh7LCGinofAGnErnkI/fBaP77i7HoLNuxvBci3RlAmcgyk5tyWLHsWGvJLYvUylnhRnCLtBP2mtyO0SMXwO5ia11EC/7UgTBZyPAzsFQNffYyFrDaiuVcY6v0U3l/qPfyUultZrHvwqe8WNLP9CrivUGUCFX/Qzs/L9+wQlK2xitQ==
购买输出: 开始轮询区块，查找 bob->0x70997970C51812dc3A010C7d01b50e0d17dc79C8 转账金额=1000000000000000000 wei
在区块 28 找到匹配交易,hash=1c7641bf869835c20b93eb74f88f4b119c9428d8a099dcc2aa367ed3d0f3e3b9
确认收到来自 0x90F79bf6EB2c4f870365E785982E1f101E93b906 的付款, 交易hash=1c7641bf869835c20b93eb74f88f4b119c9428d8a099dcc2aa367ed3d0f3e3b9

=== 调用 purchaseNFT(tokenId=2, buyer=0x90F79bf6EB2c4f870365E785982E1f101E93b906, encCid=...) ===
purchaseNFT 交易哈希: 9e24d4eae8606fc55e7c4171928b49c253ce555dc69f2c3810f817b4df9bb881
NFTPurchased => operator=0x70997970C51812dc3A010C7d01b50e0d17dc79C8, tokenId=2, dataOwner=0x976EA74026E726554dB657fA54763abd0C3a0aa9, ethPaid=1 ETH, encCid=fRVVksPSbYFioQkELbElXIvcRVldZx+GIE+NtLC05cC/wlJ0WlqRgIHxQW03K5f2baL/l/OSTDy5zMzBGZl2zVaUb4tCrK97EfelOJAAOxA0gTW+MbCRJ9XzbQhG9GyznI3FOT9cSUsLpn5g+MaF+DslHN681Gczb2FmITYl+Lh7LCGinofAGnErnkI/fBaP77i7HoLNuxvBci3RlAmcgyk5tyWLHsWGvJLYvUylnhRnCLtBP2mtyO0SMXwO5ia11EC/7UgTBZyPAzsFQNffYyFrDaiuVcY6v0U3l/qPfyUultZrHvwqe8WNLP9CrivUGUCFX/Qzs/L9+wQlK2xitQ==

 [92m=== purchaseNFT 成功, 您已获得访问权. ===[0m
===== 购买流程成功完成 =====
最终加密CID: fRVVksPSbYFioQkELbElXIvcRVldZx+GIE+NtLC05cC/wlJ0WlqRgIHxQW03K5f2baL/l/OSTDy5zMzBGZl2zVaUb4tCrK97EfelOJAAOxA0gTW+MbCRJ9XzbQhG9GyznI3FOT9cSUsLpn5g+MaF+DslHN681Gczb2FmITYl+Lh7LCGinofAGnErnkI/fBaP77i7HoLNuxvBci3RlAmcgyk5tyWLHsWGvJLYvUylnhRnCLtBP2mtyO0SMXwO5ia11EC/7UgTBZyPAzsFQNffYyFrDaiuVcY6v0U3l/qPfyUultZrHvwqe8WNLP9CrivUGUCFX/Qzs/L9+wQlK2xitQ==
